parameters:
  name: ""
  clusterName: ""
  region: ""

steps:
  - task: AzureCLI@2
    displayName: Delete - ${{ parameters.name }}
    env:
      AZCLI: az
      CLUSTER: ${{ parameters.clusterName }}
      REGION: ${{ parameters.region }}
      SUB: ${{ parameters.sub }}
    inputs:
      azureSubscription: ${{ parameters.svcConn }}
      scriptLocation: "inlineScript"
      scriptType: "bash"
      addSpnToEnvironment: true
      inlineScript: |
        echo "Deleting cluster"
        make -C ./hack/aks azcfg
        make -C ./hack/aks set-kubeconf
        make -C ./hack/aks down
        echo "Cluster and resources down"
